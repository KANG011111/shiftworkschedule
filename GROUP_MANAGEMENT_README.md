# 群組管理功能說明

## 🎯 功能概述
在班表上傳頁面新增了完整的群組人員管理功能，讓管理員可以方便地管理5個工作群組的人員名單。

## 📋 支援的群組
- **📊 統籌組** (藍色)
- **💡 燈光組** (黃色) 
- **🎭 舞台組** (綠色)
- **🔊 視聽組** (紅色)
- **🔧 維護組** (灰色)

## ✨ 主要功能

### 1. 群組人員管理
- 每個群組都有獨立的文字輸入區域
- 一行輸入一個人員姓名
- 即時顯示各群組的人數統計
- 自動更新人數計算

### 2. 資料持久化
- 群組資料儲存在資料庫中 (`group_members` 表)
- 頁面重新載入時自動載入已儲存的設定
- 支援新增、修改、刪除群組成員

### 3. API 端點
- `GET /api/group-members` - 獲取所有群組資料
- `POST /api/group-members` - 儲存所有群組設定
- `PUT /api/group-members/<group_name>` - 更新特定群組

### 4. 整合功能
- 與現有的班表匯入功能完全整合
- 支援新的群組選項和舊版本兼容群組
- 自動從群組管理系統載入白名單資料

## 🔧 使用方式

### 訪問群組管理
1. 登入系統 (admin/admin123)
2. 進入 "班表匯入驗證系統" 頁面
3. 向下滾動到 "群組人員管理" 區域

### 管理群組成員
1. 在對應群組的文字框中輸入人員姓名（一行一個）
2. 系統會即時顯示人數統計
3. 點擊 "儲存群組設定" 保存所有變更
4. 點擊 "重新載入設定" 恢復到上次儲存的狀態
5. 點擊 "清空所有群組" 清除所有群組資料

### 群組選擇選項
在CSV上傳時，可以選擇以下群組：
- 📊 統籌組
- 💡 燈光組  
- 🎭 舞台組
- 🔊 視聽組
- 🔧 維護組
- 演出人員 (統籌+舞台)
- 技術人員 (燈光+視聽+維護)  
- 全名單（不過濾）

## 💾 資料庫結構

### GroupMembers 表
```sql
CREATE TABLE group_members (
    id INTEGER PRIMARY KEY,
    group_name VARCHAR(50) UNIQUE NOT NULL,
    member_names TEXT,  -- JSON格式的成員名單
    updated_at DATETIME,
    created_at DATETIME
);
```

### 預設群組
系統啟動時會自動創建5個空的群組記錄。

## 🔄 向後兼容性
- 完全兼容現有的白名單系統
- 優先從群組管理系統載入資料
- 如果群組管理系統無資料，會回退到舊的JSON檔案
- 舊版本的群組選項仍然可用

## 🧪 測試建議
1. 在各群組中新增測試人員名單
2. 儲存設定並重新載入頁面，確認資料保持
3. 上傳CSV檔案，選擇不同群組進行匯入測試
4. 驗證首頁和員工頁面能正確顯示匯入的人員

## 🚀 技術實現
- **後端**: Flask + SQLAlchemy + JSON序列化
- **前端**: Bootstrap + JavaScript + AJAX
- **資料庫**: SQLite (支援其他資料庫)
- **整合**: 與現有班表系統無縫整合

群組管理功能現已完全整合到系統中，可以立即使用！